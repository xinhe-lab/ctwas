<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FAQ • ctwas</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="FAQ">
<meta property="og:description" content="ctwas">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctwas</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.21</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/minimal_tutorial.html">A minimal tutorial of running cTWAS without LD</a>
    </li>
    <li>
      <a href="../articles/preparing_input_data.html">Preparing cTWAS input data</a>
    </li>
    <li>
      <a href="../articles/running_ctwas_analysis.html">Running cTWAS analysis</a>
    </li>
    <li>
      <a href="../articles/summarizing_results.html">Summarizing and visualizing cTWAS results</a>
    </li>
    <li>
      <a href="../articles/sample_report.html">Sample report of cTWAS results</a>
    </li>
    <li>
      <a href="../articles/postprocessing.html">Post-processing cTWAS results</a>
    </li>
    <li>
      <a href="../articles/utility_functions.html">cTWAS utility functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/FAQ.html">FAQ</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/software_updates.html">Software updates</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/xinhe-lab/ctwas/tree/multigroup" class="external-link">Source</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="FAQ_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>FAQ</h1>
                        <h4 data-toc-skip class="author">Kaixuan Luo</h4>
            
            <h4 data-toc-skip class="date">2024-12-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/xinhe-lab/ctwas/blob/multigroup/vignettes/FAQ.Rmd" class="external-link"><code>vignettes/FAQ.Rmd</code></a></small>
      <div class="hidden name"><code>FAQ.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="common-questions">Common questions<a class="anchor" aria-label="anchor" href="#common-questions"></a>
</h2>
<div class="section level3">
<h3 id="can-i-run-ctwas-if-my-gwas-data-and-prediction-models-have-different-genome-builds">Can I run cTWAS if my GWAS data and prediction models have different genome builds?<a class="anchor" aria-label="anchor" href="#can-i-run-ctwas-if-my-gwas-data-and-prediction-models-have-different-genome-builds"></a>
</h3>
<p>It is critical that the genome build (e.g. hg38) of the LD reference matches the genome build used to train the prediction models. You can use the function <code><a href="../reference/get_predictdb_genome_build.html">get_predictdb_genome_build()</a></code> to check the genome build of PredictDB weight file.</p>
<p>The genome build of the GWAS summary statistics does not matter because variant positions are determined by the LD reference.</p>
</div>
<div class="section level3">
<h3 id="can-i-use-my-own-ld-matrices-as-reference">Can I use my own LD matrices as reference?<a class="anchor" aria-label="anchor" href="#can-i-use-my-own-ld-matrices-as-reference"></a>
</h3>
<p>By default, we use our own LD matrices in “.RDS” format. We also support other common formats, such as “.Rdata”, “.mtx”, “.csv”, “.txt”. If you already have LD matrices in custom format, you could directly load your own LD matrices, and don’t need to save those in our LD matrix format. To do this, you could write a loader function that loads your LD matrices into our LD matrix format. Then set <code>LD_format = "custom"</code> and pass your loader function to the argument <code>LD_loader_fun</code>.</p>
<p>If your variant information files are custom format, you can also write a loader function to read your own variant information files, and then pass your loader function to the argument <code>snpinfo_loader_fun</code>.</p>
</div>
<div class="section level3">
<h3 id="how-can-i-create-my-own-ld-matrices-as-references-from-genotype-data">How can I create my own LD matrices as references from genotype data?<a class="anchor" aria-label="anchor" href="#how-can-i-create-my-own-ld-matrices-as-references-from-genotype-data"></a>
</h3>
<p>cTWAS provides a function <code><a href="../reference/convert_geno_to_LD_matrix.html">convert_geno_to_LD_matrix()</a></code> to create LD matrices from individual level genotype data. See the tutorial <a href="https://xinhe-lab.github.io/multigroup_ctwas/articles/utility_functions.html" class="external-link">“cTWAS utility functions”</a> for details.</p>
</div>
<div class="section level3">
<h3 id="can-i-use-ctwas-to-analyze-gwas-from-non-european-ancestry">Can I use cTWAS to analyze GWAS from non-European ancestry?<a class="anchor" aria-label="anchor" href="#can-i-use-ctwas-to-analyze-gwas-from-non-european-ancestry"></a>
</h3>
<p>Running cTWAS with a different ancestry is under development. For now, we recommend using LD reference matching the GWAS samples (not the weights).</p>
</div>
<div class="section level3">
<h3 id="is-there-any-way-to-speed-up-the-computation">Is there any way to speed up the computation?<a class="anchor" aria-label="anchor" href="#is-there-any-way-to-speed-up-the-computation"></a>
</h3>
<p>To save running time, we parallelized computations when running cTWAS main function and several other modular functions. We currently use the forking approach for parallelization, so it does not work on Windows.</p>
<p>You could set <code>ncore</code> to control how many cores are used in the parallelization. When processing LD matrices, especially during screening regions and fine-mapping, we recommend using larger memory. If you use the cTWAS main function, we have an argument <code>ncore_LD</code>, which allows using a lower number of cores during screening regions and fine-mapping steps, so more memory will be allocated for those steps.</p>
</div>
<div class="section level3">
<h3 id="my-parameters-look-strange--what-should-i-do">My parameters look strange. What should I do?<a class="anchor" aria-label="anchor" href="#my-parameters-look-strange--what-should-i-do"></a>
</h3>
<p>The most important parameters of cTWAS are the “enrichment” parameters, the ratio of prior inclusion probabilities of molecular traits vs. variants. In our experience, these numbers usually range from 20 - 200. If the numbers are outside this range, check the prior variance parameters. When the variance parameters are very different between molecular traits and variants, you can get exceedingly large enrichment. In that case, you can specify the same prior variance parameters for molecular traits and genes, by setting <code>group_prior_var_structure = "shared_all"</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="potential-error-messages-when-running-ctwas">Potential error messages when running cTWAS<a class="anchor" aria-label="anchor" href="#potential-error-messages-when-running-ctwas"></a>
</h2>
<div class="section level3">
<h3 id="error-message-some-snps-in-weights-not-found-in-z_snp-when-running-compute_gene_z-function">Error message: “Some SNPs in weights not found in z_snp!” when running compute_gene_z() function<a class="anchor" aria-label="anchor" href="#error-message-some-snps-in-weights-not-found-in-z_snp-when-running-compute_gene_z-function"></a>
</h3>
<p>We limit variants in the processed weights to the processed variants in <code>z_snp</code> (by setting <code>gwas_snp_ids = z_snp$id</code>), so you should first run <code><a href="../reference/preprocess_z_snp.html">preprocess_z_snp()</a></code>, and then run <code><a href="../reference/preprocess_weights.html">preprocess_weights()</a></code> after getting processed variants. If you later changed the SNPs included in <code>z_snp</code>, you would need to rerun preprocess_weights() with <code>gwas_snp_ids</code> set to the updated <code>z_snp$id</code>.</p>
</div>
<div class="section level3">
<h3 id="error-message-r-matrix-dimension-does-not-match-with-z">Error message: “R matrix dimension does not match with z!”<a class="anchor" aria-label="anchor" href="#error-message-r-matrix-dimension-does-not-match-with-z"></a>
</h3>
<p>This message suggests conflicts between the correlation matrices and the Z-scores when running fine-mapping. This often happens when you run cTWAS main function or fine-mapping using new data but load correlation matrices saved from an earlier analysis. By default, cTWAS will automatically load correlation matrices saved in <code>cor_dir</code>, so it will cause conflicts when you run different cTWAS analyses with the same <code>cor_dir</code>. So please make sure to save correlation matrices to a new directory when running new cTWAS analyses. Each cTWAS analysis should use a separate <code>cor_dir</code> to store the correlation matrices.</p>
</div>
<div class="section level3">
<h3 id="error-message-viewport-has-zero-dimensions-when-making-the-locus-plots-">Error message: “Viewport has zero dimension(s)” when making the locus plots.<a class="anchor" aria-label="anchor" href="#error-message-viewport-has-zero-dimensions-when-making-the-locus-plots-"></a>
</h3>
<p>If you get an error message “Viewport has zero dimension(s)” when making locus plots, it usually suggests the R viewer window is too small. You can try increasing the size of the viewer window size and try again.</p>
</div>
<div class="section level3">
<h3 id="missing-shapes-in-the-legend-of-locus-plots-when-including-many-types-of-molecular-traits">Missing shapes in the legend of locus plots when including many types of molecular traits<a class="anchor" aria-label="anchor" href="#missing-shapes-in-the-legend-of-locus-plots-when-including-many-types-of-molecular-traits"></a>
</h3>
<p>We included several default shapes to represent different types of molecular traits. If you have more types of molecular traits or if you want to change the shapes, you can set the <code>point.shapes</code>argument in the function <code><a href="../reference/make_locusplot.html">make_locusplot()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="error-message-null-found-in-mclapply-output--results-may-be-incomplete">Error message: " ‘NULL’ found in mclapply output. Results may be incomplete!"**<a class="anchor" aria-label="anchor" href="#error-message-null-found-in-mclapply-output--results-may-be-incomplete"></a>
</h3>
<p>This message is often caused by insufficient memory when running cTWAS with multiple cores in parallel. You could use a larger memory, or set a lower <code>ncore</code>. If you still get this error message, try <code>ncore=1</code> to run without parallelization.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Siming Zhao, Wesley Crouse, Sheng Qian, Kaixuan Luo, Matthew Stephens, Xin He.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
